{"version":3,"sources":["../../server/models/game.js"],"names":["mongoose","require","Schema","GameSchema","screenshots","Array","gameConsole","Number","cover","String","summary","id","name","owner","type","Types","ObjectId","ref","pre","next","User","model","find","populate","then","console","log","user","Game","module","exports"],"mappings":";;AAAA,IAAMA,WAAWC,QAAQ,UAAR,CAAjB;AACA,IAAMC,SAASF,SAASE,MAAxB;;AAEA,IAAMC,aAAa,IAAID,MAAJ,CAAW;AAC5BE,eAAaC,KADe;AAE5BC,eAAaC,MAFe;AAG5BC,SAAOC,MAHqB;AAI5BC,WAASD,MAJmB;AAK5BE,MAAIJ,MALwB;AAM5BK,QAAMH,MANsB;AAO5BI,SAAO;AACLC,UAAMZ,OAAOa,KAAP,CAAaC,QADd;AAELC,SAAK;AAFA;AAPqB,CAAX,CAAnB;;AAaAd,WAAWe,GAAX,CAAe,QAAf,EAAyB,UAASC,IAAT,EAAe;AACtC,MAAMC,OAAOpB,SAASqB,KAAT,CAAe,OAAf,CAAb;;AAEA;AACA;AACA;AACA;AACA;;AAEAD,OAAKE,IAAL,CAAU,EAACX,IAAI,KAAKA,EAAV,EAAV,EACGY,QADH,CACY,OADZ,EAEGC,IAFH,CAEQ,gBAAQ;AACZC,YAAQC,GAAR,CAAY,SAAZ,EAAuBC,IAAvB;AACAR;AACA;;;;;;;;;;AAUD,GAfH;AAgBD,CAzBD;;AA2BA,IAAMS,OAAO5B,SAASqB,KAAT,CAAe,OAAf,EAAwBlB,UAAxB,CAAb;;AAEA0B,OAAOC,OAAP,GAAiBF,IAAjB","file":"game.js","sourcesContent":["const mongoose = require('mongoose');\r\nconst Schema = mongoose.Schema;\r\n\r\nconst GameSchema = new Schema({\r\n  screenshots: Array,\r\n  gameConsole: Number,\r\n  cover: String,\r\n  summary: String,\r\n  id: Number,\r\n  name: String,\r\n  owner: {\r\n    type: Schema.Types.ObjectId,\r\n    ref: 'users'\r\n  }\r\n});\r\n\r\nGameSchema.pre('remove', function(next) {\r\n  const User = mongoose.model('users');\r\n\r\n  //User.remove({games: this.id}, next);\r\n  //User.remove({ games: this._id }, next);\r\n  //next();\r\n  //console.log(this.owner);\r\n  //next();\r\n\r\n  User.find({id: this.id})\r\n    .populate('games')\r\n    .then(user => {\r\n      console.log('user is', user);\r\n      next();\r\n      /*\r\n      Array.from(user.games).map((game, key) => {\r\n        if (game._id.toString() === this._id.toString()) {\r\n          console.log( user.games[key]._id);\r\n          user.games[key]._id = null;\r\n          user.save(() => {\r\n            next();\r\n          });\r\n        }\r\n      });*/\r\n    });\r\n});\r\n\r\nconst Game = mongoose.model('games', GameSchema);\r\n\r\nmodule.exports = Game;\r\n\r\n"]}