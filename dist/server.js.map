{"version":3,"sources":["../server/server.js"],"names":["express","require","path","cookieParser","bodyParser","mongoose","users","trades","games","requests","connect","Promise","global","session","MongoStore","db","connection","app","use","json","urlencoded","extended","static","secret","saveUninitialized","resave","cookie","maxAge","httpOnly","store","mongooseConnection","ttl","post","req","res","destroy","send","get","undefined","redirect","sendFile","resolve","__dirname","listen","process","env","PORT","console","log"],"mappings":";;AAAA,IAAMA,UAAUC,QAAQ,SAAR,CAAhB;AACA,IAAMC,OAAOD,QAAQ,MAAR,CAAb;AACA;AACA,IAAME,eAAeF,QAAQ,eAAR,CAArB;AACA,IAAMG,aAAaH,QAAQ,aAAR,CAAnB;AACA,IAAMI,WAAWJ,QAAQ,UAAR,CAAjB;AACA,IAAMK,QAAQL,QAAQ,gBAAR,CAAd;AACA,IAAMM,SAASN,QAAQ,iBAAR,CAAf;AACA,IAAMO,QAAQP,QAAQ,gBAAR,CAAd;AACA,IAAMQ,WAAWR,QAAQ,mBAAR,CAAjB;;AAEAI,SAASK,OAAT,CAAiB,2BAAjB;AACA;AACAL,SAASM,OAAT,GAAmBC,OAAOD,OAA1B;;AAEA,IAAME,UAAUZ,QAAQ,iBAAR,CAAhB;AACA,IAAMa,aAAab,QAAQ,eAAR,EAAyBY,OAAzB,CAAnB;;AAEA,IAAME,KAAKV,SAASW,UAApB;;AAEA,IAAMC,MAAMjB,SAAZ;;AAEA;AACAiB,IAAIC,GAAJ,CAAQd,WAAWe,IAAX,EAAR;AACAF,IAAIC,GAAJ,CAAQd,WAAWgB,UAAX,CAAsB,EAACC,UAAU,KAAX,EAAtB,CAAR;AACAJ,IAAIC,GAAJ,CAAQf,cAAR;AACAc,IAAIC,GAAJ,CAAQlB,QAAQsB,MAAR,CAAe,QAAf,CAAR;;AAEAL,IAAIC,GAAJ,CAAQL,QAAQ;AACdU,UAAQ,SADM;AAEdC,qBAAmB,IAFL;AAGdC,UAAQ,IAHM;AAIdC,UAAQ,EAACC,QAAQ,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAAjB,GAAsB,CAA/B,EAAkCC,UAAU,KAA5C,EAJM,EAI8C;AAC5DC,SAAO,IAAIf,UAAJ,CAAe,EAACgB,oBAAoBf,EAArB,EAAyBgB,KAAK,IAAI,EAAJ,GAAS,EAAT,GAAc,EAA5C,EAAf;AALO,CAAR,CAAR;;AAQAd,IAAIC,GAAJ,CAAQ,QAAR,EAAkBZ,KAAlB;AACAW,IAAIC,GAAJ,CAAQ,QAAR,EAAkBV,KAAlB;AACAS,IAAIC,GAAJ,CAAQ,SAAR,EAAmBX,MAAnB;AACAU,IAAIC,GAAJ,CAAQ,WAAR,EAAqBT,QAArB;;AAEAQ,IAAIe,IAAJ,CAAS,aAAT,EAAwB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACpCD,MAAIpB,OAAJ,CAAYsB,OAAZ,CAAoB,YAAM;AACxB;AACA,WAAOD,IAAIE,IAAJ,CAAS,eAAT,CAAP;AACD,GAHD;AAID,CALD;;AAOAnB,IAAIoB,GAAJ,CAAQ,GAAR,EAAa,UAACJ,GAAD,EAAMC,GAAN,EAAc;AACzB;AACA;AACA,MAAIA,IAAIrB,OAAJ,KAAgByB,SAApB,EAA+B;AAC7B,WAAOJ,IAAIK,QAAJ,CAAa,GAAb,CAAP;AACD;;AAEDL,MAAIM,QAAJ,CAAatC,KAAKuC,OAAL,CAAaC,SAAb,EAAwB,WAAxB,EAAqC,YAArC,CAAb;AACD,CARD;;AAUAzB,IAAI0B,MAAJ,CAAWC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAA/B,EAAqC,YAAM;AACzCC,UAAQC,GAAR,CAAY,mBAAZ;AACD,CAFD","file":"server.js","sourcesContent":["const express = require('express');\r\nconst path = require('path');\r\n// const logger = require('morgan');\r\nconst cookieParser = require('cookie-parser');\r\nconst bodyParser = require('body-parser');\r\nconst mongoose = require('mongoose');\r\nconst users = require('./routes/users');\r\nconst trades = require('./routes/trades');\r\nconst games = require('./routes/games');\r\nconst requests = require('./routes/requests');\r\n\r\nmongoose.connect('mongodb://localhost/local');\r\n//mongoose.connect(process.env.MONGOLAB_URI);\r\nmongoose.Promise = global.Promise;\r\n\r\nconst session = require('express-session');\r\nconst MongoStore = require('connect-mongo')(session);\r\n\r\nconst db = mongoose.connection;\r\n\r\nconst app = express();\r\n\r\n// app.use(logger('dev'));\r\napp.use(bodyParser.json());\r\napp.use(bodyParser.urlencoded({extended: false}));\r\napp.use(cookieParser());\r\napp.use(express.static('static'));\r\n\r\napp.use(session({\r\n  secret: 'noodles',\r\n  saveUninitialized: true,\r\n  resave: true,\r\n  cookie: {maxAge: 1000 * 60 * 60 * 24 * 2, httpOnly: false}, // 2 days\r\n  store: new MongoStore({mongooseConnection: db, ttl: 2 * 24 * 60 * 60})\r\n}));\r\n\r\napp.use('/users', users);\r\napp.use('/games', games);\r\napp.use('/trades', trades);\r\napp.use('/requests', requests);\r\n\r\napp.post('/logoutUser', (req, res) => {\r\n  req.session.destroy(() => {\r\n    // setTimeout(5, () => db.close());\r\n    return res.send('session ended');\r\n  });\r\n});\r\n\r\napp.get('*', (req, res) => {\r\n  // makes sure user is logged into before directing\r\n  // to dashboard\r\n  if (res.session === undefined) {\r\n    return res.redirect('/');\r\n  }\r\n\r\n  res.sendFile(path.resolve(__dirname, '../static', 'index.html'));\r\n});\r\n\r\napp.listen(process.env.PORT || 3000, () => {\r\n  console.log('App started again');\r\n});\r\n"]}